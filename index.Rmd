---
title: "BREVE ANÁLISE DOS DADOS DO SERVIÇO SMP (TELEFONIA CELULAR)"
author: "Jose Ivan Maia"
date: "24 de outubro de 2018"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Objeto

Essa análise objetiva estudar os dados do serviço móvel pessoal- SMP, coletados no Portal Anatel, por meio da abordagem dos seguintes tópicos:


1. Análise dos dados de avaliação da percepção dos usuários em relação ao funcionamento do serviço SMP; 

2. Análise da correlação entre a infraestrutura das operadoras e a nota de percepção recebida;  

3. Análise da quantidade de linhas de celular e a população e a sua distribuição regional.


## Objetivos


* Verificar de forma regionalizada quais foram as operadoras melhores avaliadas no quesito "funcionamento do serviço de celular" na Pesquisa de satisfação da qualidade percebida, realizada anualmente pela Anatel.

* Investigar se as notas obtidas na pesquisa têm alguma correlação com a infraestrutura que as operadoras têm nos respectivos Estados. Em teoria a tendência é que quanto mais antenas disponíveis uma operadora possui, melhor é o sinal e a experiência do usuário no serviço. 

* Cruzar os dados da população brasileira com os dados de quantidades de linhas habilitadas e verificar a sua distribuição e a proporção de linhas por habitantes de forma regionalizada.

## Contexto

Desde 2015 a Agência Nacional de Telecomunicações promove a aferição do Grau de Satisfação e da Qualidade Percebida junto ao Usuários de Serviços de Telecomunicações.Isso é feito por meio de uma pesquisa cujo população-alvo é composta por todos os usuários do serviço, com idade mínima de 18 (dezoito anos), na condição de principal usuário, com registro em nome de pessoa física e residentes de todas as Unidades da Federação (UF), as notas variam de 0 "totalmente insatisfeito") a 10 ("totalmente satisfeito").

A pesquisa mede diversos aspectos e serviços de telefonia, no entanto nesse estudo foi selecionada apenas a nota para o quesito funcionamento do serviço de celular. Na pesquisa as notas foram divididas entre linhas pré e pós pagas. Para o estudo foi considerado o serviço como um todo, sendo a nota utilizada a média obtidas nas duas modalidades.

## 

Além dessa pesquisa, a Anatel coleta mensalmente diversos dados que são disponibilizados em sua página na Internet. Para o estudo foram selecionados os dados de Acessos do SMP dos últimos 3 anos, que significa a quantidade de usuários do serviço e os dados de infraestrutura, onde estão disponíveis diversas informações técnicas sobre as ERBS-estação rádio Base e as antenas que nela são instaladas por cada entidade outorgada. 

Nesse trabalho foram selecionado para estudo apenas os dados das 4 maiores operadoras do país, por possuirem atuação em todo território nacional, respectivamente a CLARO, a OI, a TIM e a VIVO.  

## Método

Primeiramente foram obtidos os dados de Infraestrutura ([Portal Anate - Infraestrutura - Telefonia Móvel)  ](https://sistemas.anatel.gov.br/se/public/view/b/licenciamento.php). 

Foi necessário realizar 27 extrações de tabelas CSV contendo os dados técnicos da infraestrutura das operadoras, uma para a cada Estado da Federação. Nessas tabelas CSV, nomeadas respecticvamente de UF-csv_licenciamento, cada linha do arquivo corresponde a uma antena, desse modo para saber a quantidade de antenas disponíveis por Operadora em cada Estado foi contada a quantidade de linhas filtradas por operadora. 

Ao final foram gerados 27 data.frame, que foram unidos por meio da função full_join e deu origem ao Data.Frame "Antenas", contendo a UF, a Operadora e a suas respectivas quantidade de antenas. 

## 

Em seguida foi trabalhado os dados de acessos, obtidos em ([Portal Anatel - TELEFONIA MÓVEL - ACESSOS) ](https://cloud.anatel.gov.br/index.php/s/TpaFAwSw7RPfBa8?path=%2FMovel_Pessoal). 

O CSV Acessos_SMP_2015-2018_-_Total possui a informação da quantidade de linhas dos 3 últimos anos, por Estado e por empresa, além de dados das tecnologias e velocidades da internet móvel.  

No estudo os dados foram filtrados e sumarizados para gerar o Data.Frame "Acessos", contendo a UF, a Operadora e a quantidade de acessos do último mês disponível, no caso agosto de 2018.

## 
Por conseguinte, os Data.Frame Antenas e Acessos foram unidos e deram origem ao Data.Frame SMP, contendo os dados de UF, Operadora, Quantidade de Acessos e a Quantidade de antenas.

Em adição, foi gerado manualmente o vetor Notas, com as notas extraídas do último relatório da pesquisa de satisfação.([Portal Anatel-Satisfação e Qualidade Percebida - 2017)](http://www.anatel.gov.br/consumidor/pesquisa-de-satisfacao-e-qualidade/2017). Esses dados estão disponíveis apenas em forma de relatório no Portal da Agência , assim não foi possível sua inserção por meio importação do Dataset. Esse vetor foi inserido ao Data.Frame "SMP".

##
Para a apresentação gráfica o número de antenas foi comparado previamente ao número de clientes de cada operadora por estado da Federação. Assim, foi obtido a quantidade média de usuários por antena.

No segundo segmento foi criado o Data.Frame "SMP_POP, que foi originado a partir do Data.Frame SMP sumarizado por UF. Nele foi acrescentado manualmente um vetor com a População dos Estados brasileiros retirados do último senso do IBGE ao Data.Frame SMP. Em seguida foi acrescida uma coluna com a proporção de linhas de celular por habitantes.

Para apresentação gráfica, o SMP_POP foi divido por Região (Norte, Nordeste, Centro-Oeste, SUl e Sudeste) para melhor representar a proporção. Assim, foram criados 5 novos Data.Frame com os dados sumarizados pelas respectivas Regiões, contendo a quantidade de linhas, de habitantes e a proporção da Região. 




```{r include=FALSE}
library(tidyverse)

AC.csv_licenciamento <- read.csv("E:/Nova pasta/AC-csv_licenciamento.csv", dec=",")

AC <- AC.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)


AL.csv_licenciamento <- read.csv("E:/Nova pasta/AL-csv_licenciamento.csv", dec=",")
AL <- AL.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)


AM.csv_licenciamento <- read.csv("E:/Nova pasta/AM-csv_licenciamento.csv", dec=",")
AM <- AM.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)



AP.csv_licenciamento <- read.csv("E:/Nova pasta/AP-csv_licenciamento.csv", dec=",")

AP <- AP.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)

BA.csv_licenciamento <- read.csv("E:/Nova pasta/BA-csv_licenciamento.csv", dec=",")
BA <- BA.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)

CE.csv_licenciamento <- read.csv("E:/Nova pasta/CE-csv_licenciamento.csv", dec=",")
CE <- CE.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)

DF.csv_licenciamento <- read.csv("E:/Nova pasta/DF-csv_licenciamento.csv", dec=",")

DF <- DF.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)

ES.csv_licenciamento <- read.csv("E:/Nova pasta/ES-csv_licenciamento.csv", dec=",")
ES <- ES.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  
  select(UF, Operadora) %>% 
  
  group_by(UF, Operadora)%>%
  count(UF)

GO.csv_licenciamento <- read.csv("E:/Nova pasta/GO-csv_licenciamento.csv", dec=",")
GO <- GO.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

MA.csv_licenciamento <- read.csv("E:/Nova pasta/MA-csv_licenciamento.csv", dec=",")

MA <- MA.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

MG.csv_licenciamento <- read.csv("E:/Nova pasta/MG-csv_licenciamento.csv", dec=",")
MG <- MG.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

MS.csv_licenciamento <- read.csv("E:/Nova pasta/MS-csv_licenciamento.csv", dec=",")
MS <- MS.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

MT.csv_licenciamento <- read.csv("E:/Nova pasta/MT-csv_licenciamento.csv", dec=",")

MT <- MT.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

PA.csv_licenciamento <- read.csv("E:/Nova pasta/PA-csv_licenciamento.csv", dec=",")
PA <- PA.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)


PB.csv_licenciamento <- read.csv("E:/Nova pasta/PB-csv_licenciamento.csv", dec=",")

PB <- PB.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

PE.csv_licenciamento <- read.csv("E:/Nova pasta/PE-csv_licenciamento.csv", dec=",")
PE <- PE.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

PI.csv_licenciamento <- read.csv("E:/Nova pasta/PI-csv_licenciamento.csv", dec=",")

PI <- PI.csv_licenciamento%>% 
  
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

PR.csv_licenciamento <- read.csv("E:/Nova pasta/PR-csv_licenciamento.csv", dec=",")

PR <- PR.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

RJ.csv_licenciamento <- read.csv("E:/Nova pasta/RJ-csv_licenciamento.csv", dec=",")
RJ <- RJ.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

RN.csv_licenciamento <- read.csv("E:/Nova pasta/RN-csv_licenciamento.csv", dec=",")
RN <- RN.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)


RO.csv_licenciamento <- read.csv("E:/Nova pasta/RO-csv_licenciamento.csv", dec=",")
RO <- RO.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

RR.csv_licenciamento <- read.csv("E:/Nova pasta/RR-csv_licenciamento.csv", dec=",")

RR <- RR.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
  group_by(UF, Operadora)%>%
  count(UF)

RS.csv_licenciamento <- read.csv("E:/Nova pasta/RS-csv_licenciamento.csv", dec=",")
RS <- RS.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%   
  select(UF, Operadora) %>% 
  group_by(UF, Operadora)%>%
  count(UF)

SC.csv_licenciamento <- read.csv("E:/Nova pasta/SC-csv_licenciamento.csv", dec=",")
SC <- SC.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

SE.csv_licenciamento <- read.csv("E:/Nova pasta/SE-csv_licenciamento.csv", dec=",")

SE <- SE.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)

SP.csv_licenciamento <- read.csv("E:/Nova pasta/SP-csv_licenciamento.csv", dec=",")
SP <- SP.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)


TO.csv_licenciamento <- read.csv("E:/Nova pasta/TO-csv_licenciamento.csv", dec=",")

TO <- TO.csv_licenciamento%>% 
  
  rename(Operadora=NomeEntidade) %>%
  rename(UF=SiglaUf) %>% 
  mutate(Operadora = (str_replace(Operadora,"OI MÓVEL S.A.", "OI")))  %>% 
  mutate(Operadora = (str_replace(Operadora,"TIM CELULAR S.A.", "TIM"))) %>%
  mutate(Operadora = (str_replace(Operadora,"CLARO S.A.", "CLARO"))) %>% 
  mutate(Operadora = (str_replace(Operadora,"TELEFÔNICA BRASIL S.A.", "VIVO"))) %>%
  select(UF, Operadora) %>% 
group_by(UF, Operadora)%>%
  count(UF)



Antenas <- AC %>% 
 full_join(AL) %>% 
full_join(AM) %>% 
full_join(AP) %>% 
full_join(BA) %>% 
full_join(CE) %>% 
full_join(DF) %>% 
full_join(ES) %>% 
full_join(GO) %>% 
full_join(MA) %>% 
full_join(MG) %>% 
full_join(MS) %>% 
full_join(MT) %>% 
full_join(PA) %>% 
full_join(PB) %>% 
full_join(PE) %>% 
full_join(PI) %>% 
full_join(PR) %>% 
full_join(RJ) %>% 
full_join(RN) %>% 
full_join(RO) %>% 
full_join(RR) %>% 
full_join(RS) %>% 
full_join(SC) %>% 
full_join(SE) %>% 
full_join(SP) %>% 
full_join(TO) %>% 
    
    filter(Operadora== "CLARO"| Operadora=="OI"| Operadora== "TIM"| 
           Operadora== "VIVO") %>% 
    rename(Antenas = n) %>% 
  select(Antenas, UF, Operadora) %>%
  arrange(UF)
  

  
  
  Acessos_SMP_2015.2018_._Total <- read.csv2("E:/planilha R/Acessos_SMP_2015-2018_-_Total.csv")
  
  Acessos <- Acessos_SMP_2015.2018_._Total %>%
    select(-Empresa, -CNPJ, -DDD, -CNPJ, -Tecnologia, -Tipo) %>% 
    filter(Grupo=="OI"| Grupo=="TELECOM AMERICAS"| Grupo=="TELEFÔNICA"| Grupo=="GVT"| Grupo=="TELECOM ITALIA" | Grupo=="TELMEX (CLARO/EMBRATEL/NET)" | Grupo=="TELECOM ITALIA (TIM)") %>% 
        mutate(Operadora = (str_replace(Grupo,"TELEFÔNICA", "VIVO"))) %>% 
        mutate(Operadora = (str_replace(Operadora,"TELECOM AMERICAS", "CLARO"))) %>% 
           mutate(Operadora =(str_replace(Operadora,"TELECOM ITALIA", "TIM"))) %>% 
    mutate(Operadora =(str_replace(Operadora,"GVT", "VIVO"))) %>%
    mutate(Operadora = (str_replace(Operadora,"TELMEX" , "CLARO"))) %>% 
               mutate(Linhas=(X2018.08)) %>%
            select(UF, Operadora, Linhas) %>% 
           group_by(UF, Operadora) %>% 
    summarise(Linhas=sum(Linhas)) %>% 
    arrange(UF)
    Acessos <- Acessos[3:110, ]
  
  
  SMP <- Antenas %>% 
            full_join(Acessos)
  
  Notas <- c(7.8,	7.58,	7.65,	6.6,	7.59,	6.62,	6.98,	7.96,	7.65,	7.43,	7.35,	6.46,	7.96,	6.73,	7.17,	6.73,	6.89,	6.41,	7.01,	7.45,	7.65,
             6.18,	7.38,	8.18,	6.64,	6.65,	6.83,	7.69,	7.79,	7.34,	7.62,	7.06,	6.65,	6.79,	6.81,	7.37,	7.61,	6.24,	6.76,	7.8,	6.72,
             6.35,	6.57,	7.31,	6.91,	7.29,	6.91,	7.16,	7.24,	6.9,	7.25,	6.89,	7.8,	6.97,	6.43,	7.15,	7.56,	6.24,	7.08,	8.22,	7.54,
             6.33,	7.25,	8.09,	7.21,	7.06,	6.79,	7.88,	7.06,	6.95,	6.49,	7.37,	6.91,	6.83,	7.53,	7.67,	7.47,	6.52,	6.89,	8.1,
             7.36,	6.98,	7.24,	7.82,	7.65,	6.64,	6.87,	6.53,	7.31,	6.79,	7.11,	7.03,	6.9,	7.05,	6.75,	7.58,	7.37,	7	,7.69,	6.96,	7.09,
             6.88,	7.03,	7.16,	7.51,	6.61,	7.25,	7.76)
  

  
SMP <- data.frame(SMP, Notas) 

POP <- c(871825,	3325989,	4092380,	832201,	14825285,	9086801,	2979358,	3980834,	6940794,	7043454,	
         21065361, 2753486,	3448969,	8531573,	3999553,	9509642,	3265685,	11363358,	17177993,	3484629,
         1761118,	582096,	11336566,	7090694,	2282445,	45605385,	1558941)

SMP_POP <- SMP %>% 
  group_by(UF) %>% 
  summarise(T_Linhas=sum(Linhas))
  
  SMP_POP <- data.frame(SMP_POP, POP)
  
  SMP_POP %>%  
     mutate(proporcao = (T_Linhas/POP))


Norte <- SMP_POP %>% 
  filter(UF=="AC"| UF=="AP"| UF=="AM"|UF=="PA"|UF=="RO"|UF=="RR"|UF=="TO") %>%
  summarise(Regiao= "Norte", Linhas=sum(T_Linhas),  Habitantes=sum(POP), Proporcao=(sum(T_Linhas)/Habitantes))

Nordeste<- SMP_POP%>% 
  filter(UF=="AL"| UF=="BA"| UF=="CE"|UF=="MA"|UF=="PB"|UF=="PE"|UF=="PI"|UF=="RN"|UF=="SE") %>%
  summarise(Regiao= "Nordeste",Linhas=sum(T_Linhas), Habitantes=sum(POP), Proporcao=(sum(T_Linhas)/Habitantes))

Centro_Oeste<- SMP_POP %>% 
  filter(UF=="DF"| UF=="GO"| UF=="MT"|UF=="MS") %>%
  
  summarise(Regiao= "Centro-Oeste",Linhas=sum(T_Linhas), Habitantes=sum(POP), Proporcao=(sum(T_Linhas)/Habitantes))

Sudeste<- SMP_POP %>% 
  filter(UF=="ES"| UF=="MG"| UF=="RJ"|UF=="SP") %>%
  summarise(Regiao= "Sudeste" , Linhas=sum(T_Linhas),Habitantes=sum(POP), Proporcao=(sum(T_Linhas)/Habitantes))

Sul<- SMP_POP %>% 
  filter(UF=="PR"| UF=="SC"| UF=="RS") %>%
  summarise(Regiao= "Sul",Linhas=sum(T_Linhas), Habitantes=sum(POP), Proporcao=(sum(T_Linhas)/Habitantes))


Regiao <- Norte %>% 
  full_join(Nordeste) %>% 
  full_join(Centro_Oeste)%>% 
  full_join(Sudeste) %>% 
  full_join(Sul)


```

## Gráfico 1 
```{r pressure1}
#Gráfico 1: Mapa de notas das Operadoras por Estado

SMP%>% 
  ggplot(aes(Operadora,UF)) + 
  geom_tile(aes(fill=Notas)) + ggtitle("Mapa de notas das Operadoras por Estado")

```

## Gráfico 2 
```{r pressure2}
#Gráfico 2: Nota média obtida pelas Operadoras por Estado
SMP %>% 
  group_by(UF) %>% 
  summarise(Nota_media=mean(Notas)) %>% 
  ggplot(aes(x=UF, y=Nota_media, fill=Nota_media) 
  )+geom_bar(stat = "identity", alpha=0.6)+
  labs(title = "Nota média de todas as operadoras por Estado ", x ="UF", y ="Nota Média")  
```

## Gráfico 3 
```{r pressure3}
#Gráfico 3: Dispersão da relação entre a variável Quantidade de antenas por assinante e a Nota recebida na pesquisa de qualidade. 

        SMP%>% 
    ggplot(aes(x= Notas, y=(Linhas/Antenas), color=UF)) + 
  geom_point() + labs(title = "Dispersão da relação entre a quantidade de antenas por usuários e a Nota ", x ="notas", y ="Número médio de antenas por usuários")
 
``` 

## Gráfico 4
```{r pressure4} 

        SMP%>% 
          ggplot(aes(x= Notas, y=(Linhas/Antenas), color=Operadora))+
          geom_point()+stat_smooth(method = "lm") +labs(title = "Regressão Linear da relação entre número de antenas por usuários e as Notas", x ="Notas", y ="Número médio de antenas por usuários")
        
```  

## Gráfico 5
```{r pressure5} 


        #Gráfico 5: Proporção de linhas de celular por habitantes
 Regiao%>% 
          ggplot(aes(x=Linhas/100 , y=Habitantes/100, color=Regiao, size=Proporcao)) + 
          geom_point() +
  labs(title = "Proporção de linhas de celular por habitantes ", x ="Quantidade de Linhas habilitadas", y ="População Brasileira/100")
```

## Conclusão

* Gráfico 1: Mapa de notas das Operadoras por Estado - A primeira análise buscou visualizar como as notas de cada Operadora estavam distribuídas nos Estados. Pelo mapa das cores é possível perceber que a OI mostra um número mais acentuado de avaliações baixas. Enquanto a Vivo aparenta ser a melhor avaliada no quesito funcionamento do serviço de celular.

##
* Gráfico 2: Nota média obtida pelas Operadoras por Estado - Na segunda análise foi feita um extração da média das notas de todas as Operadoras por Estado. Por conseguinte, o Estado de Minas Gerais apresentou as menores médias de notas, o que denota que a percepção dos usuários quanto ao funcionamento do serviço de celular não está boa, comparada aos demais Estados da Federação.

Em contrapartida, os usuários do Espirito Santos demostraram estar satisfeitos com o Funcionamento do SMP no Estado, uma vez que foi o Estado onde as Operadoras tiveram a maior média geral na avaliação.

## 
* Gráfico 3: Dispersão da relação entre a variável Quantidade de antenas por assinante e a Nota recebida na pesquisa de qualidade - Nessa análise buscou se estudar se a nota obtida pela operadora tinha relação com a sua infraestrutura. Conforme verifica-se no gráfico 3 a dispersão obtida não permite afirmar haver uma correlação positiva entre essas duas variáveis.

* Gráfico 4: Regressão Linear da relação entre número de antenas por usuários e as Notas - Nesse gráfico foi inserida uma linha de regressão linear para cada Operadora. O resultado visualizado no gráfico mostra uma correlação negativa entre a quantidade média de usuários por antenas e as Notas obtidas.

##
O resultado evidenciou não haver relação positiva direta entre a infraestrutura da operadora e a percepção que seu usuário tem do seu serviço, considerando apenas esse aspecto da quantidade de antenas.

Ao contrário, o cálculo da correlação mostrou haver uma relação negativa pequena, que denota que as operadoras com mais usuários por antenas obtiveram melhor pontuação.

Isso pode significar que essas operadoras com mais usuários por antenas oferecem um melhor serviço, quando se considera outros aspectos como o preço, atendimento, promoções, etc., e por isso tem mais clientes por antenas e são mais bem avaliadas.

## 

* Gráfico 5: Proporção de linhas de celular por habitantes - Na segunda parte do estudo foi analisada a proporção de celular por habitante. Por meio do Gráfico 5 é possivel  observar a correlação quase perfeita entre a População e quantidade de linhas. 

Quanto à proporção, a que Região que apresenta a maior proporção de celular por habitantes é a Centro-Oeste, mesmo tendo a segunda menor população entre as regiões. Enquanto a região Norte tema menor proporção de linhas por habitantes e a menor população.  
  




